<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hop — hop • slider</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hop — hop"><meta name="description" content="hop() is the lower level engine that powers slide() (at least in theory).
It has slightly different invariants than slide(), and is useful
when you either need to hand craft boundary locations, or want to compute a
result with a size that is different from .x."><meta property="og:description" content="hop() is the lower level engine that powers slide() (at least in theory).
It has slightly different invariants than slide(), and is useful
when you either need to hand craft boundary locations, or want to compute a
result with a size that is different from .x."><meta name="robots" content="noindex"><script defer data-domain="slider.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">slider</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/slider.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rowwise.html">Row-wise iteration with slider</a></li>
    <li><a class="dropdown-item" href="../articles/tsibble.html">Converting from tsibble</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/slider/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hop</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/slider/blob/main/R/hop.R" class="external-link"><code>R/hop.R</code></a></small>
      <div class="d-none name"><code>hop.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hop()</code> is the lower level engine that powers <code><a href="slide.html">slide()</a></code> (at least in theory).
It has slightly different invariants than <code><a href="slide.html">slide()</a></code>, and is useful
when you either need to hand craft boundary locations, or want to compute a
result with a size that is different from <code>.x</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hop</span><span class="op">(</span><span class="va">.x</span>, <span class="va">.starts</span>, <span class="va">.stops</span>, <span class="va">.f</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hop_vec</span><span class="op">(</span><span class="va">.x</span>, <span class="va">.starts</span>, <span class="va">.stops</span>, <span class="va">.f</span>, <span class="va">...</span>, .ptype <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--x">.x<a class="anchor" aria-label="anchor" href="#arg--x"></a></dt>
<dd><p><code>[vector]</code></p>
<p>The vector to iterate over and apply <code>.f</code> to.</p></dd>


<dt id="arg--starts-stops">.starts, .stops<a class="anchor" aria-label="anchor" href="#arg--starts-stops"></a></dt>
<dd><p><code>[integer]</code></p>
<p>Vectors of boundary locations that make up the windows to bucket <code>.x</code> with.
Both <code>.starts</code> and <code>.stops</code> will be recycled to their common size, and
that common size will be the size of the result. Both vectors should be
integer locations along <code>.x</code>, but out-of-bounds values are allowed.</p></dd>


<dt id="arg--f">.f<a class="anchor" aria-label="anchor" href="#arg--f"></a></dt>
<dd><p><code>[function / formula]</code></p>
<p>If a <strong>function</strong>, it is used as is.</p>
<p>If a <strong>formula</strong>, e.g. <code>~ .x + 2</code>, it is converted to a function. There
are three ways to refer to the arguments:</p><ul><li><p>For a single argument function, use <code>.</code></p></li>
<li><p>For a two argument function, use <code>.x</code> and <code>.y</code></p></li>
<li><p>For more arguments, use <code>..1</code>, <code>..2</code>, <code>..3</code> etc</p></li>
</ul><p>This syntax allows you to create very compact anonymous functions.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to the mapped function.</p></dd>


<dt id="arg--ptype">.ptype<a class="anchor" aria-label="anchor" href="#arg--ptype"></a></dt>
<dd><p><code>[vector(0) / NULL]</code></p>
<p>A prototype corresponding to the type of the output.</p>
<p>If <code>NULL</code>, the default, the output type is determined by computing the
common type across the results of the calls to <code>.f</code>.</p>
<p>If supplied, the result of each call to <code>.f</code> will be cast to that type,
and the final output will have that type.</p>
<p>If <code>getOption("vctrs.no_guessing")</code> is <code>TRUE</code>, the <code>.ptype</code> must be
supplied. This is a way to make production code demand fixed types.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector fulfilling the following invariants:</p>
<div class="section">
<h3 id="hop-"><code>hop()</code><a class="anchor" aria-label="anchor" href="#hop-"></a></h3>

<ul><li><p><code>vec_size(hop(.x, .starts, .stops)) == vec_size_common(.starts, .stops)</code></p></li>
<li><p><code>vec_ptype(hop(.x, .starts, .stops)) == list()</code></p></li>
</ul></div>

<div class="section">
<h3 id="hop-vec-"><code>hop_vec()</code><a class="anchor" aria-label="anchor" href="#hop-vec-"></a></h3>

<ul><li><p><code>vec_size(hop_vec(.x, .starts, .stops)) == vec_size_common(.starts, .stops)</code></p></li>
<li><p><code>vec_size(hop_vec(.x, .starts, .stops)[[1]]) == 1L</code></p></li>
<li><p><code>vec_ptype(hop_vec(.x, .starts, .stops, .ptype = ptype)) == ptype</code></p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>hop()</code> is very close to being a faster version of:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">map2</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  .starts,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  .stops,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="cf">function</span>(start, stop) {</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    x_slice <span class="ot">&lt;-</span> <span class="fu">vec_slice</span>(.x, start<span class="sc">:</span>stop)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="fu">.f</span>(x_slice, ...)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  }</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p>Because of this, <code><a href="hop_index.html">hop_index()</a></code> is often the more useful function. <code>hop()</code>
mainly exists for API completeness.</p>
<p>The main difference is that the start and stop values make up ranges of
<em>possible</em> locations along <code>.x</code>, and it is not enforced that these locations
actually exist along <code>.x</code>. As an example, with <code>hop()</code> you can do the
following, which would be an error with <code>vec_slice()</code> because <code>0L</code> is
out of bounds.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">hop</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>), <span class="at">.starts =</span> <span class="dv">0</span><span class="dt">L</span>, <span class="at">.stops =</span> <span class="dv">1</span><span class="dt">L</span>, <span class="sc">~</span>.x)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; [1] "a"</span></span></code></pre><p></p></div>
<p><code>hop()</code> allows these out of bounds values to be fully compatible with
<code><a href="slide.html">slide()</a></code>. It is always possible to construct a <code>hop()</code> call from a <code><a href="slide.html">slide()</a></code>
call. For example, the following are equivalent:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">slide</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="sc">~</span>.x, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">hop</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">.starts =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">.stops =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="sc">~</span>.x)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hop2.html">hop2()</a></code>, <code><a href="hop_index.html">hop_index()</a></code>, <code><a href="slide.html">slide()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># `hop()` let's you manually specify locations to apply `.f` at.</span></span></span>
<span class="r-in"><span><span class="fu">hop</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, .starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, .stops <span class="op">=</span> <span class="fl">3</span>, <span class="op">~</span><span class="va">.x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `hop()`'s start/stop locations are allowed to be out of bounds relative</span></span></span>
<span class="r-in"><span><span class="co"># to the size of `.x`.</span></span></span>
<span class="r-in"><span><span class="fu">hop</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>  .starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  .stops  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">.x</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4      21   6  160 110  3.9 2.620 16.46  0  1    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

