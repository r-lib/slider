<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Converting from tsibble • slider</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Converting from tsibble">
<meta name="robots" content="noindex">
<script defer data-domain="slider.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">slider</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/slider.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rowwise.html">Row-wise iteration with slider</a></li>
    <li><a class="dropdown-item" href="../articles/tsibble.html">Converting from tsibble</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/slider/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Converting from tsibble</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/slider/blob/main/vignettes/tsibble.Rmd" class="external-link"><code>vignettes/tsibble.Rmd</code></a></small>
      <div class="d-none name"><code>tsibble.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://tsibble.tidyverts.org/" class="external-link">tsibble</a> package is
where the name <code><a href="../reference/slide.html">slide()</a></code> originated. It contained original
implementations of <code><a href="../reference/slide.html">slide()</a></code> and friends, along with
variations like <code>tile()</code> and <code>stretch()</code>, all of
which have been superceded by slider. As of tsibble 1.0.0, those
functions have been completely removed in favor of using slider. The
goal of this vignette is to explain how to transition from tsibble to
slider.</p>
<div class="section level2">
<h2 id="slide">slide()<a class="anchor" aria-label="anchor" href="#slide"></a>
</h2>
<p>tsibble’s <code>.size</code> and <code>.align</code> arguments are
roughly equivalent to using <code>.before</code> and <code>.after</code>
in slider. In tsibble, you’d specify the full width of the window with
<code>.size</code>, and then you’d specify how to construct that window
by <code>.align</code>ing yourself to the left, right, or center. In
slider, you always start at the “current” element, and then specify how
many elements <code>.before</code> and <code>.after</code> the current
element that you want in the window. The width of the window in slider
terms could be computed as <code>.after - .before + 1</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span></span>
<span><span class="co"># The current element, and 1 before it</span></span>
<span><span class="fu">slider</span><span class="fu">::</span><span class="fu"><a href="../reference/slide.html">slide</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .before <span class="op">=</span> <span class="fl">1</span>, .complete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Window size of 2, assume the current element is the right side of the window</span></span>
<span><span class="fu">tsibble</span><span class="fu">::</span><span class="fu">slide</span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .size <span class="op">=</span> <span class="fl">2</span>, .align <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span></code></pre></div>
<p>We also have to set the <code>.complete</code> argument of slider’s
<code><a href="../reference/slide.html">slide()</a></code> to <code>TRUE</code>, as by default slider allows
partial windows, but tsibble’s version does not. The equivalent argument
to this in tsibble is <code>.partial</code> (note that they are
interpreted inversely of each other).</p>
<p>There is no <code>.fill</code> equivalent in slider. slider always
uses the vctrs definition of a missing value (a typed <code>NA</code>
for most vectors, a <code>NULL</code> for lists). This is why the slider
result above has a <code>NULL</code>, while the tsibble result used an
<code>NA</code> (the default <code>.fill</code> value in tsibble).</p>
<p>Specifying windows using <code>.before</code> and <code>.after</code>
might first feel a bit unnatural to a tsibble or zoo user, but it is
generally more flexible. You can generate irregular windows that aren’t
possible with tsibble, like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The current element, along with 1 before and 3 after (if they exist)</span></span>
<span><span class="fu">slider</span><span class="fu">::</span><span class="fu"><a href="../reference/slide.html">slide</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">identity</span>, .before <span class="op">=</span> <span class="fl">1</span>, .after <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 2 3 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 3 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 5 6</span></span></code></pre></div>
<p>As you will see in the next section, expanding windows are easy to
create by setting <code>.before</code> or <code>.after</code> to
<code>Inf</code>.</p>
<p>This syntax also translates naturally to <code><a href="../reference/slide_index.html">slide_index()</a></code>,
where the bounds of the window are (by default) computed as
<code>.i - .before</code> and <code>.i + .after</code>, which often
cannot be expressed by a single window size value.</p>
</div>
<div class="section level2">
<h2 id="tile">tile()<a class="anchor" aria-label="anchor" href="#tile"></a>
</h2>
<p>Tiling uses non-overlapping windows. For example, this segments
<code>x</code> into 4 non-overlapping buckets, where as many buckets as
possible have a window size of 3.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="fu">tsibble</span><span class="fu">::</span><span class="fu">tile</span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 7 8 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>There is no direct equivalent to this in slider, but you can get
close with <code><a href="../reference/slide.html">slide()</a></code>. <code>tile()</code> seems to left-align
the index, so we need the current element plus two <code>.after</code>
it. Since this is a non-overlapping window, we want to
<code>.step</code> forward by the size of the window, three.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">slider</span><span class="fu">::</span><span class="fu"><a href="../reference/slide.html">slide</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .after <span class="op">=</span> <span class="fl">2</span>, .step <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 7 8 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>This isn’t exactly the same, as <code><a href="../reference/slide.html">slide()</a></code> is guaranteed to
be size-stable, returning an object with the same size as
<code>.x</code>. However, if you <code><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">purrr::compact()</a></code> the
result to drop the <code>NULL</code> values, then they are
equivalent.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">compact</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 4 5 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 7 8 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stretch">stretch()<a class="anchor" aria-label="anchor" href="#stretch"></a>
</h2>
<p>To construct expanding windows with tsibble, you’ve probably used
<code>stretch()</code>. This fixes an initial window size, and then
expands to add more observations without dropping any.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span></span>
<span><span class="fu">tsibble</span><span class="fu">::</span><span class="fu">stretch</span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
<p>With slider, you can set <code>.before = Inf</code> to select the
current element plus all elements before this one.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">slider</span><span class="fu">::</span><span class="fu"><a href="../reference/slide.html">slide</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .before <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
<p><code>stretch()</code> allows you to set <code>.init</code> to fix an
initial minimum window size:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tsibble</span><span class="fu">::</span><span class="fu">stretch</span><span class="op">(</span><span class="va">x</span>, <span class="va">identity</span>, .init <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
<p>There isn’t a direct equivalent of this in slider, but your function
could return <code>NULL</code> if the current window size didn’t hold
enough elements:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">identity3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="cn">NULL</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">x</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">slider</span><span class="fu">::</span><span class="fu"><a href="../reference/slide.html">slide</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">identity3</span>, .before <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

  </div></footer>
</body>
</html>
